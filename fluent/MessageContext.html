<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Class: MessageContext</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Class: MessageContext</h1>

    




<section>

<header>
    
        <h2>MessageContext</h2>
        
            <div class="class-description"><p>Message contexts are single-language stores of translations.  They are
responsible for parsing translation resources in the Fluent syntax and can
format translation units (entities) to strings.</p>
<p>Always use <code>MessageContext.format</code> to retrieve translation units from
a context.  Translations can contain references to other entities or
external arguments, conditional logic in form of select expressions, traits
which describe their grammatical features, and can use Fluent builtins which
make use of the <code>Intl</code> formatters to format numbers, dates, lists and more
into the context's language.  See the documentation of the Fluent syntax for
more information.</p></div>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    
    <h2>Constructor</h2>
    

    <h4 class="name" id="MessageContext"><span class="type-signature"></span>new MessageContext<span class="signature">()</span><span class="type-signature"></span></h4>

    















<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="context.js.html">context.js</a>, <a href="context.js.html#line18">line 18</a>
    </li></ul></dd>
    

    

    

    
</dl>
















    
    </div>

    

    

    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="addMessages"><span class="type-signature"></span>addMessages<span class="signature">(source)</span><span class="type-signature"> &rarr; {Array.&lt;Error>}</span></h4>

    



<div class="description">
    <p>Add a translation resource to the context.</p>
<p>The translation resource must use the Fluent syntax.  It will be parsed by
the context and each translation unit (message) will be available in the
<code>messages</code> map by its identifier.</p>
<pre class="prettyprint source"><code>ctx.addMessages('foo = Foo');
ctx.messages.get('foo');

// Returns a raw representation of the 'foo' message.</code></pre><p>Parsed entities should be formatted with the <code>format</code> method in case they
contain logic (references, select expressions etc.).</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>source</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>Text resource with translations.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="context.js.html">context.js</a>, <a href="context.js.html#line77">line 77</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;Error></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="format"><span class="type-signature"></span>format<span class="signature">(message, args, errors)</span><span class="type-signature"> &rarr; (nullable) {string}</span></h4>

    



<div class="description">
    <p>Format a message to a string or null.</p>
<p>Format a raw <code>message</code> from the context's <code>messages</code> map into a string (or
a null if it has a null value).  <code>args</code> will be used to resolve references
to external arguments inside of the translation.</p>
<p>In case of errors <code>format</code> will try to salvage as much of the translation
as possible and will still return a string.  For performance reasons, the
encountered errors are not returned but instead are appended to the
<code>errors</code> array passed as the third argument.</p>
<pre class="prettyprint source"><code>const errors = [];
ctx.addMessages('hello = Hello, { $name }!');
const hello = ctx.messages.get('hello');
ctx.format(hello, { name: 'Jane' }, errors);

// Returns 'Hello, Jane!' and `errors` is empty.

ctx.format(hello, undefined, errors);

// Returns 'Hello, name!' and `errors` is now:

[&lt;ReferenceError: Unknown external: name>]</code></pre>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>message</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>
|

<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>args</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>
|

<span class="param-type">undefined</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>errors</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="context.js.html">context.js</a>, <a href="context.js.html#line171">line 171</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="formatToParts"><span class="type-signature"></span>formatToParts<span class="signature">(message, args, errors)</span><span class="type-signature"> &rarr; (nullable) {Array.&lt;<a href="FluentType.html">FluentType</a>>}</span></h4>

    



<div class="description">
    <p>Format a message to an array of <code>FluentTypes</code> or null.</p>
<p>Format a raw <code>message</code> from the context's <code>messages</code> map into an array of
<code>FluentType</code> instances which may be used to build the final result.  It
may also return <code>null</code> if it has a null value.  <code>args</code> will be used to
resolve references to external arguments inside of the translation.</p>
<p>See the documentation of <a href="MessageContext.html#format"><code>MessageContext#format</code></a> for more
information about error handling.</p>
<p>In case of errors <code>format</code> will try to salvage as much of the translation
as possible and will still return a string.  For performance reasons, the
encountered errors are not returned but instead are appended to the
<code>errors</code> array passed as the third argument.</p>
<pre class="prettyprint source"><code>ctx.addMessages('hello = Hello, { $name }!');
const hello = ctx.messages.get('hello');
ctx.formatToParts(hello, { name: 'Jane' }, []);
// → ['Hello, ', '\u2068', 'Jane', '\u2069']</code></pre><p>The returned parts need to be formatted via <code>valueOf</code> before they can be
used further.  This will ensure all values are correctly formatted
according to the <code>MessageContext</code>'s locale.</p>
<pre class="prettyprint source"><code>const parts = ctx.formatToParts(hello, { name: 'Jane' }, []);
const str = parts.map(part => part.valueOf(ctx)).join('');</code></pre>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>message</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>
|

<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>args</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>
|

<span class="param-type">undefined</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>errors</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="context.js.html">context.js</a>, <a href="context.js.html#line120">line 120</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="MessageContext.html#format">MessageContext#format</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;<a href="FluentType.html">FluentType</a>></span>


    </dd>
</dl>

    



        
    

    

    
</article>

</section>







<section>

<header>
    
        <h2>MessageContext</h2>
        
    
</header>

<article>
    <div class="container-overview">
    
        

    

    <h4 class="name" id="MessageContext"><span class="type-signature"></span>new MessageContext<span class="signature">(lang, options<span class="signature-attributes">opt</span>)</span><span class="type-signature"> &rarr; {<a href="MessageContext.html">MessageContext</a>}</span></h4>

    



<div class="description">
    <p>Create an instance of <code>MessageContext</code>.</p>
<p>The <code>lang</code> argument is used to instantiate <code>Intl</code> formatters used by
translations.  The <code>options</code> object can be used to configure the context.</p>
<p>Examples:</p>
<pre class="prettyprint source"><code>const ctx = new MessageContext(lang);

const ctx = new MessageContext(lang, { useIsolating: false });

const ctx = new MessageContext(lang, {
  useIsolating: true,
  functions: {
    NODE_ENV: () => process.env.NODE_ENV
  }
});</code></pre><p>Available options:</p>
<ul>
<li><p><code>functions</code> - an object of additional functions available to</p>
<pre class="prettyprint source"><code>          translations as builtins.</code></pre></li>
<li><p><code>useIsolating</code> - boolean specifying whether to use Unicode isolation</p>
<pre class="prettyprint source"><code>           marks (FSI, PDI) for bidi interpolations.</code></pre></li>
</ul>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        
        <th>Attributes</th>
        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>lang</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            
                <td class="attributes">
                

                

                
                </td>
            

            

            <td class="description last"><p>Language of the context.</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>options</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            
                <td class="attributes">
                
                    &lt;optional><br>
                

                

                
                </td>
            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="context.js.html">context.js</a>, <a href="context.js.html#line51">line 51</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type"><a href="MessageContext.html">MessageContext</a></span>


    </dd>
</dl>

    



    
    </div>

    

    

    

     

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="addMessages"><span class="type-signature"></span>addMessages<span class="signature">(source)</span><span class="type-signature"> &rarr; {Array.&lt;Error>}</span></h4>

    



<div class="description">
    <p>Add a translation resource to the context.</p>
<p>The translation resource must use the Fluent syntax.  It will be parsed by
the context and each translation unit (message) will be available in the
<code>messages</code> map by its identifier.</p>
<pre class="prettyprint source"><code>ctx.addMessages('foo = Foo');
ctx.messages.get('foo');

// Returns a raw representation of the 'foo' message.</code></pre><p>Parsed entities should be formatted with the <code>format</code> method in case they
contain logic (references, select expressions etc.).</p>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>source</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"><p>Text resource with translations.</p></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="context.js.html">context.js</a>, <a href="context.js.html#line77">line 77</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;Error></span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="format"><span class="type-signature"></span>format<span class="signature">(message, args, errors)</span><span class="type-signature"> &rarr; (nullable) {string}</span></h4>

    



<div class="description">
    <p>Format a message to a string or null.</p>
<p>Format a raw <code>message</code> from the context's <code>messages</code> map into a string (or
a null if it has a null value).  <code>args</code> will be used to resolve references
to external arguments inside of the translation.</p>
<p>In case of errors <code>format</code> will try to salvage as much of the translation
as possible and will still return a string.  For performance reasons, the
encountered errors are not returned but instead are appended to the
<code>errors</code> array passed as the third argument.</p>
<pre class="prettyprint source"><code>const errors = [];
ctx.addMessages('hello = Hello, { $name }!');
const hello = ctx.messages.get('hello');
ctx.format(hello, { name: 'Jane' }, errors);

// Returns 'Hello, Jane!' and `errors` is empty.

ctx.format(hello, undefined, errors);

// Returns 'Hello, name!' and `errors` is now:

[&lt;ReferenceError: Unknown external: name>]</code></pre>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>message</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>
|

<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>args</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>
|

<span class="param-type">undefined</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>errors</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="context.js.html">context.js</a>, <a href="context.js.html#line171">line 171</a>
    </li></ul></dd>
    

    

    

    
</dl>













<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">string</span>


    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="formatToParts"><span class="type-signature"></span>formatToParts<span class="signature">(message, args, errors)</span><span class="type-signature"> &rarr; (nullable) {Array.&lt;<a href="FluentType.html">FluentType</a>>}</span></h4>

    



<div class="description">
    <p>Format a message to an array of <code>FluentTypes</code> or null.</p>
<p>Format a raw <code>message</code> from the context's <code>messages</code> map into an array of
<code>FluentType</code> instances which may be used to build the final result.  It
may also return <code>null</code> if it has a null value.  <code>args</code> will be used to
resolve references to external arguments inside of the translation.</p>
<p>See the documentation of <a href="MessageContext.html#format"><code>MessageContext#format</code></a> for more
information about error handling.</p>
<p>In case of errors <code>format</code> will try to salvage as much of the translation
as possible and will still return a string.  For performance reasons, the
encountered errors are not returned but instead are appended to the
<code>errors</code> array passed as the third argument.</p>
<pre class="prettyprint source"><code>ctx.addMessages('hello = Hello, { $name }!');
const hello = ctx.messages.get('hello');
ctx.formatToParts(hello, { name: 'Jane' }, []);
// → ['Hello, ', '\u2068', 'Jane', '\u2069']</code></pre><p>The returned parts need to be formatted via <code>valueOf</code> before they can be
used further.  This will ensure all values are correctly formatted
according to the <code>MessageContext</code>'s locale.</p>
<pre class="prettyprint source"><code>const parts = ctx.formatToParts(hello, { name: 'Jane' }, []);
const str = parts.map(part => part.valueOf(ctx)).join('');</code></pre>
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>message</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>
|

<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>args</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>
|

<span class="param-type">undefined</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>errors</code></td>
            

            <td class="type">
            
                
<span class="param-type">Array</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="context.js.html">context.js</a>, <a href="context.js.html#line120">line 120</a>
    </li></ul></dd>
    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="MessageContext.html#format">MessageContext#format</a></li>
        </ul>
    </dd>
    

    
</dl>













<h5>Returns:</h5>

        


<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Array.&lt;<a href="FluentType.html">FluentType</a>></span>


    </dd>
</dl>

    



        
    

    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="FluentType.html">FluentType</a></li><li><a href="MessageContext.html">MessageContext</a></li><li><a href="RuntimeParser.html">RuntimeParser</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Thu Feb 23 2017 21:38:08 GMT+0100 (CET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>